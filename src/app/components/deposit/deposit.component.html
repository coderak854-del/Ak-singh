
<div class="w-full max-w-md mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-8" style="background-color: var(--secondary-bg);">
    
    @if (!submissionSuccess()) {
        <div>
            <h1 class="text-2xl md:text-3xl font-bold text-gray-100 text-center">Make a Deposit</h1>
            <p class="text-gray-400 text-center mt-2 mb-6">Select a payment method to proceed.</p>

            <div class="flex justify-center gap-4 mb-6">
                <button (click)="selectPaymentMethod('gpay')" class="payment-btn flex-1 font-semibold py-3 px-4 rounded-xl transition-all duration-300"
                    [class]="selectedMethod() === 'gpay' ? 'bg-blue-600 text-white ring-2 ring-blue-300' : 'bg-gray-700 text-gray-200'">Google Pay</button>
                <button (click)="selectPaymentMethod('phonepe')" class="payment-btn flex-1 font-semibold py-3 px-4 rounded-xl transition-all duration-300"
                    [class]="selectedMethod() === 'phonepe' ? 'bg-blue-600 text-white ring-2 ring-blue-300' : 'bg-gray-700 text-gray-200'">PhonePe</button>
            </div>

            @if(selectedMethod()) {
              <div class="text-center">
                  <p class="mb-4 text-gray-300">Scan this QR to pay.</p>
                  <div class="qr-code-container inline-block p-4 bg-white rounded-2xl border">
                      @if(isQrLoading()) {
                        <div class="w-56 h-56 flex items-center justify-center"><div class="loader"></div></div>
                      }
                      @if(qrCodeUrl()) {
                        <img [src]="qrCodeUrl()" alt="QR Code" class="w-56 h-56 mx-auto">
                      }
                  </div>
                  <p class="mt-4 text-sm text-gray-400 font-medium">After payment, please fill the form below.</p>
              </div>
              
              <div class="mt-6">
                  <h2 class="text-xl font-semibold text-gray-200 mb-4">Submit Payment Details</h2>
                  <form #depositForm="ngForm" (ngSubmit)="submitDetails()">
                      <div class="space-y-4">
                          <div>
                              <label for="userName" class="block text-sm font-medium text-gray-400">Your Name</label>
                              <input type="text" id="userName" name="userName" required class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" [(ngModel)]="userName">
                          </div>
                          <div>
                              <label for="userId" class="block text-sm font-medium text-gray-400">Your User ID</label>
                              <input type="text" id="userId" name="userId" required class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" [value]="userId()" disabled>
                          </div>
                          <div>
                              <label for="amount" class="block text-sm font-medium text-gray-400">Amount Sent</label>
                              <input type="number" id="amount" name="amount" required class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" [(ngModel)]="amount">
                          </div>
                          <div>
                              <label for="transactionId" class="block text-sm font-medium text-gray-400">UPI Transaction ID (Ref No.)</label>
                              <input type="text" id="transactionId" name="transactionId" required class="mt-1 block w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500" [(ngModel)]="transactionId">
                          </div>
                      </div>
                      <button type="submit" class="mt-6 w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition" [disabled]="isSubmitting()">
                        @if(isSubmitting()) { Submitting... } @else { Submit Details }
                      </button>
                  </form>
              </div>
            }
        </div>
    } @else {
      <div class="text-center py-10">
          <svg class="mx-auto h-16 w-16 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
          <h2 class="mt-4 text-2xl font-bold text-gray-100">Request Submitted Successfully!</h2>
          <p class="mt-2 text-gray-300">Your deposit will be reflected in your account after admin approval.</p>
      </div>
    }
</div>
